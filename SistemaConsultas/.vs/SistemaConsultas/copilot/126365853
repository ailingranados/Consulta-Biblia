0{"DateTime":"2023-11-13T02:59:29.1782331Z","Version":0,"CopilotSessionId":{"Guid":"2a7c7347-8bb3-4e4c-817e-b3ef646ab2a6","ClientId":{"Id":"Microsoft.VisualStudio.Conversations.Chat.HelpWindow"}},"Request":{"Prompt":"INT_Versiculo = DGV_consulta.CurrentRow.Cells[4].Value.ToString(); quiero cambiarlo a int","Context":{"VisibleDocuments":[],"PreSelectedSkill":null,"CorrelationId":{"Guid":"00000000-0000-0000-0000-000000000000"}}},"Response":{"Content":"\u0060\u0060\u0060C#\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.ComponentModel;\r\nusing System.Data;\r\nusing System.Drawing;\r\nusing System.Globalization;\r\nusing System.Linq;\r\nusing System.Text;\r\nusing System.Threading.Tasks;\r\nusing System.Windows.Forms;\r\n\r\n\r\nnamespace CapaPresentacion2\r\n{\r\n    public partial class Consulta_IdiomaVersion : Form\r\n    {\r\n        private static int usuarioActualId;\r\n\r\n        private static DataTable Idiomas;\r\n        private static DataTable Versiones;\r\n        private static int id_idioma;\r\n        private static int id_version;\r\n        private static DataTable Testamentos;\r\n        private static int id_testamento;\r\n        private static DataTable Libro;\r\n        private static int id_libro;\r\n        private static DataTable DT_Versiculo;\r\n        private static int id_versiculo;\r\n\r\n        private static DataTable DT_consulta;\r\n\r\n\r\n        //favoritos\r\n        private static string STR_ID_SELECCIONADO;\r\n\r\n        private static string STR_Idioma;\r\n        private static string STR_Version;\r\n        private static string STR_Testamento;\r\n        private static string STR_Libro;\r\n        private static int INT_Versiculo;\r\n\r\n        public Consulta_IdiomaVersion(int id_usu)\r\n        {\r\n            usuarioActualId = id_usu;\r\n            InitializeComponent();\r\n        }\r\n\r\n        private void Consulta_IdiomaVersion_Load(object sender, EventArgs e)\r\n        {\r\n            int i = 0;\r\n            EnlaceDB ConsultarIdioma = new EnlaceDB();\r\n            Idiomas = ConsultarIdioma.Consultar_Idioma();\r\n\r\n\r\n            while (i \u003C Idiomas.Rows.Count)\r\n            {\r\n                CB_idioma.Items.Add(Idiomas.Rows[i][\u0022Nombre\u0022].ToString());\r\n                i\u002B\u002B;\r\n            }\r\n\r\n           \r\n\r\n        }\r\n\r\n        public void CB_idioma_SelectedIndexChanged(object sender, EventArgs e)\r\n        {\r\n            //limpiar items de version\r\n            CB_version.Items.Clear();\r\n\r\n            int j = 0;\r\n            EnlaceDB ConsultarVersion = new EnlaceDB();\r\n           \r\n\r\n            string idioma = CB_idioma.Text;\r\n\r\n            id_idioma = ConsultarVersion.Buscar_Idioma(idioma);\r\n\r\n            Versiones = ConsultarVersion.Consultar_Version(id_idioma);\r\n\r\n            while (j \u003C Versiones.Rows.Count)\r\n            {\r\n                CB_version.Items.Add(Versiones.Rows[j][\u0022NombreVersion\u0022].ToString());\r\n                j\u002B\u002B;\r\n            }\r\n\r\n            //testamento\r\n            CB_testamento.Items.Clear();\r\n\r\n            int a = 0;\r\n            EnlaceDB ConsultarTestamento = new EnlaceDB();\r\n\r\n            \r\n            Testamentos = ConsultarTestamento.Consultar_Testamento(id_idioma);\r\n\r\n            \r\n            while (a \u003C Testamentos.Rows.Count)\r\n            {\r\n                CB_testamento.Items.Add(Testamentos.Rows[a][\u0022Nombre\u0022].ToString());\r\n                a\u002B\u002B;\r\n            }\r\n\r\n\r\n        }\r\n\r\n        private void Aceptar_Click(object sender, EventArgs e)\r\n        {\r\n\r\n            EnlaceDB EDB_ConsultarDGV = new EnlaceDB();\r\n\r\n            string STR_idioma = CB_idioma.Text;\r\n\r\n            string STR_version = CB_version.Text;\r\n\r\n            string STR_testamento = CB_testamento.Text;\r\n\r\n            string STR_libro = CB_libro.Text;\r\n\r\n            string STR_versiculo = CB_versiculo.Text;\r\n\r\n            int id_versionB = EDB_ConsultarDGV.Buscar_Version(STR_version);\r\n\r\n            int id_idiomaB = EDB_ConsultarDGV.Buscar_Idioma(STR_idioma);\r\n\r\n            int id_testamentoB = EDB_ConsultarDGV.Buscar_Testamento(STR_testamento);\r\n\r\n            int id_libroB = EDB_ConsultarDGV.Buscar_Libro(STR_libro);\r\n\r\n\r\n            int id_versiculoB = EDB_ConsultarDGV.Buscar_Ver(STR_versiculo);\r\n\r\n            if ((id_testamentoB == 0) \u0026 (id_libroB == 0) \u0026 (id_versiculoB == 0))\r\n            {\r\n                DT_consulta = EDB_ConsultarDGV.Consultar_IV(id_idiomaB, id_versionB);\r\n                DGV_consulta.DataSource = DT_consulta;\r\n            }\r\n            else if((id_libroB == 0) \u0026 (id_versiculoB == 0))\r\n            {\r\n                DT_consulta = EDB_ConsultarDGV.Consultar_IVT(id_idiomaB, id_versionB, id_testamentoB);\r\n                DGV_consulta.DataSource = DT_consulta;\r\n            }\r\n            else if (id_versiculoB == 0)\r\n            {\r\n                DT_consulta = EDB_ConsultarDGV.Consultar_IVTL(id_idiomaB, id_versionB, id_testamentoB, id_libroB);\r\n                DGV_consulta.DataSource = DT_consulta;\r\n            }\r\n            else\r\n            {\r\n                DT_consulta = EDB_ConsultarDGV.Consultar_IVTLVE(id_idiomaB, id_versionB, id_testamentoB, id_libroB, id_versiculoB);\r\n                DGV_consulta.DataSource = DT_consulta;\r\n            }\r\n            \r\n\r\n        }\r\n\r\n        private void label14_Click(object sender, EventArgs e)\r\n        {\r\n\r\n        }\r\n\r\n        public void CB_testamento_SelectedIndexChanged(object sender, EventArgs e)\r\n        {\r\n            CB_libro.Items.Clear();\r\n\r\n            int b = 0;\r\n\r\n            EnlaceDB ConsultarLibro = new EnlaceDB();\r\n            string testamento = CB_testamento.Text;\r\n\r\n            id_testamento = ConsultarLibro.Buscar_Testamento(testamento);\r\n\r\n            Libro = ConsultarLibro.Consultar_Libros(id_idioma, id_testamento);\r\n\r\n            while (b \u003C Libro.Rows.Count)\r\n            {\r\n                CB_libro.Items.Add(Libro.Rows[b][\u0022Nombre\u0022].ToString());\r\n                b\u002B\u002B;\r\n            }\r\n\r\n        }\r\n\r\n        private void CB_capitulo_SelectedIndexChanged(object sender, EventArgs e)\r\n        {\r\n            \r\n        }\r\n\r\n        private void CB_versiculo_SelectedIndexChanged(object sender, EventArgs e)\r\n        {\r\n\r\n        }\r\n\r\n        private void CB_libro_SelectedIndexChanged(object sender, EventArgs e)\r\n        {\r\n            CB_versiculo.Items.Clear();\r\n            int c = 0;\r\n\r\n            EnlaceDB EDB_ConsultarVersiculo = new EnlaceDB();\r\n            \r\n            string STR_libro = CB_libro.Text;\r\n\r\n            string STR_version = CB_version.Text;\r\n\r\n            id_version = EDB_ConsultarVersiculo.Buscar_Version(STR_version);\r\n\r\n            id_libro = EDB_ConsultarVersiculo.Buscar_Libro(STR_libro);\r\n\r\n            DT_Versiculo = EDB_ConsultarVersiculo.Consultar_Versiculos(id_version, id_libro);\r\n\r\n            while (c \u003C DT_Versiculo.Rows.Count)\r\n            {\r\n                CB_versiculo.Items.Add(DT_Versiculo.Rows[c][\u0022NumeroVers\u0022].ToString());\r\n                c\u002B\u002B;\r\n            }\r\n        }\r\n\r\n        private void DGV_consulta_CellContentClick(object sender, DataGridViewCellEventArgs e)\r\n        {\r\n            label6.Text = DGV_consulta.CurrentRow.Cells[5].Value.ToString();\r\n            STR_Idioma = DGV_consulta.CurrentRow.Cells[0].Value.ToString();\r\n            STR_Version = DGV_consulta.CurrentRow.Cells[1].Value.ToString();\r\n            STR_Testamento = DGV_consulta.CurrentRow.Cells[2].Value.ToString();\r\n            STR_Libro = DGV_consulta.CurrentRow.Cells[3].Value.ToString();\r\n            INT_Versiculo = int.Parse(DGV_consulta.CurrentRow.Cells[4].Value.ToString());\r\n\r\n        }\r\n\r\n        private void CI_favorito_Click(object sender, EventArgs e)\r\n        {\r\n            EnlaceDB EDB_AgregarFavorito = new EnlaceDB();\r\n\r\n            bool B_favorito = false;\r\n            bool B_referencia = false;\r\n            int INT_id_referencia;\r\n\r\n            id_idioma = EDB_AgregarFavorito.Buscar_Idioma(STR_Idioma);\r\n\r\n            id_version = EDB_AgregarFavorito.Buscar_Version(STR_Version);\r\n\r\n            id_testamento = EDB_AgregarFavorito.Buscar_Testamento(STR_Testamento);\r\n            \r\n            id_libro = EDB_AgregarFavorito.Buscar_Libro(STR_Libro);\r\n\r\n            id_versiculo = EDB_AgregarFavorito.Buscar_Ver(STR_Versiculo);\r\n\r\n            B_referencia = EDB_AgregarFavorito.Agregar_referencia(id_idioma, id_version, id_testamento, id_libro, id_versiculo);\r\n\r\n            INT_id_referencia = EDB_AgregarFavorito.Buscar_referencia(id_idioma, id_version, id_testamento, id_libro, id_versiculo);\r\n\r\n            B_favorito = EDB_AgregarFavorito.Agregar_fav(usuarioActualId, INT_id_referencia);\r\n\r\n        }\r\n    }\r\n}\r\n\r\n\u0060\u0060\u0060","Type":1,"Status":1,"FollowUpPrompts":null},"SelectedFunctionName":"Modify","LoggedSkillInvocations":null}
0{"DateTime":"2023-11-13T02:59:29.1782331Z","Version":0,"CopilotSessionId":{"Guid":"2a7c7347-8bb3-4e4c-817e-b3ef646ab2a6","ClientId":{"Id":"Microsoft.VisualStudio.Conversations.Chat.HelpWindow"}},"Request":{"Prompt":"L_versiculo.Text = DGV_Favoritos.CurrentRow.Cells[7].Value.ToString(); quiero agregarle varias filas de informacion aqui mismo","Context":{"VisibleDocuments":[],"PreSelectedSkill":null,"CorrelationId":{"Guid":"00000000-0000-0000-0000-000000000000"}}},"Response":{"Content":"\u0060\u0060\u0060C#\r\nusing System;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.Linq;\nusing Moq;\nusing Xunit;\nusing System.ComponentModel;\r\nusing System.Drawing;\r\nusing System.Globalization;\r\nusing System.Text;\r\nusing System.Threading.Tasks;\r\nusing System.Windows.Forms;\r\n\nnamespace CapaPresentacion2.Tests\n{\n    public class FavoritosTests\n    {\n        [Fact]\n        public void SetL_versiculoText_When_DGV_FavoritosCurrentRowCellsHasValue()\n        {\n            // Arrange\n            var favoritosForm = new Favoritos(1);\n            var dgvMock = new Mock\u003CDataGridView\u003E();\n            var currentRowMock = new Mock\u003CDataGridViewRow\u003E();\n            var cellsMock = new Mock\u003CDataGridViewCellCollection\u003E();\n            var cellValueMock = new Mock\u003CDataGridViewCell\u003E();\n\n            cellValueMock.Setup(c =\u003E c.Value).Returns(\u0022Sample Value\u0022);\n            cellsMock.Setup(c =\u003E c[7]).Returns(cellValueMock.Object);\n            currentRowMock.Setup(r =\u003E r.Cells).Returns(cellsMock.Object);\n            dgvMock.Setup(d =\u003E d.CurrentRow).Returns(currentRowMock.Object);\n            favoritosForm.DGV_Favoritos = dgvMock.Object;\n\n            // Act\n            favoritosForm.SetL_versiculoText();\n\n            // Assert\n            Assert.Equal(\u0022Sample Value\u0022, favoritosForm.L_versiculo.Text);\n        }\n    }\n}\r\n\u0060\u0060\u0060","Type":1,"Status":1,"FollowUpPrompts":null},"SelectedFunctionName":"GenerateTest","LoggedSkillInvocations":null}
